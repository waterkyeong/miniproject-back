package pnu.edu.service;

import org.springframework.data.domain.Page;
import org.springframework.data.domain.PageRequest;
import org.springframework.data.domain.Pageable;
import org.springframework.stereotype.Service;

import lombok.RequiredArgsConstructor;
import pnu.edu.domain.FreeBoard;
import pnu.edu.repository.FreeBoardRepository;

@Service
@RequiredArgsConstructor
public class FreeBoardService {

	private final FreeBoardRepository freebRepo;
	
	public Page<FreeBoard> getFreeBoard(int page, int size) {
		Pageable pageable = PageRequest.of(page, size);
		
		return freebRepo.findAll(pageable);
	}
	
	public FreeBoard getFreeBoard(int freeboardid) {
		countView(freeboardid);
		return freebRepo.findById(freeboardid).get();
	}
	
	public FreeBoard countView(int freeboardid) {
		FreeBoard findB = freebRepo.findById(freeboardid).get();
		findB.setView(findB.getView()+1);
		return freebRepo.save(findB);
	}
	
	public FreeBoard insertFreeBoard(FreeBoard freeBoard) {
		freeBoard = FreeBoard.builder()
				.privateType(freeBoard.getPrivateType())
				.type(freeBoard.getType())
				.title(freeBoard.getTitle())
				.content(freeBoard.getContent())
				.img(freeBoard.getImg())
				.member(freeBoard.getMember()).build();
		return freebRepo.save(freeBoard);
	}
}
